{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12">
        <h2><i class="fas fa-book me-2"></i>Learning Resources</h2>
        <p class="text-muted">Explore resources to improve your digital awareness and data security knowledge.</p>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-12">
        <div class="card shadow">
            <div class="card-header bg-info text-white">
                <h5><i class="fas fa-info-circle me-2"></i>Digital Data Usage Information</h5>
            </div>
            <div class="card-body">
                <h6>Understanding Digital Privacy</h6>
                <p>
                    Digital privacy refers to the protection of personal information that is created, stored, 
                    or transmitted in digital form. In today's connected world, understanding how your data 
                    is collected, used, and shared is crucial for maintaining your privacy and security.
                </p>
                
                <h6 class="mt-4">Key Concepts:</h6>
                <ul>
                    <li><strong>Data Collection:</strong> Companies collect various types of data including browsing history, location, preferences, and more.</li>
                    <li><strong>Data Usage:</strong> Your data may be used for advertising, personalization, analytics, and other purposes.</li>
                    <li><strong>Privacy Settings:</strong> Most platforms offer privacy settings to control what data is shared.</li>
                    <li><strong>Permissions:</strong> Apps request permissions to access features like camera, microphone, and location.</li>
                </ul>
                
                <h6 class="mt-4">Best Practices:</h6>
                <ul>
                    <li>Regularly review and update privacy settings on social media and apps</li>
                    <li>Read privacy policies before installing new apps</li>
                    <li>Use strong, unique passwords for different accounts</li>
                    <li>Be cautious about granting app permissions</li>
                    <li>Understand what data is being collected and why</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 class="mb-0">Recommended Resources</h4>
            <small class="text-muted">
                <i class="fas fa-info-circle me-1"></i>
                Resources open in a new tab. If links don't open, check your browser's popup blocker.
            </small>
        </div>
    </div>
    {% if resources %}
        {% for resource in resources %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-{{ 'video' if resource.resource_type == 'video' else 'file-alt' }} me-2"></i>
                        {{ resource.title }}
                    </h5>
                    <p class="card-text">{{ resource.description }}</p>
                    <p class="text-muted">
                        <small>
                            <span class="badge bg-primary">{{ resource.category }}</span>
                            <span class="badge bg-secondary">{{ resource.resource_type }}</span>
                        </small>
                    </p>
                    {% if resource.url %}
                    <a href="{{ resource.url }}" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       class="btn btn-primary btn-sm"
                       onclick="handleResourceClick(event, '{{ resource.title|replace("'", "\\'") }}')">
                        <i class="fas fa-external-link-alt me-1"></i>View Resource
                    </a>
                    {% else %}
                    <span class="text-muted small">URL not available</span>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="col-md-12">
            <p class="text-muted">No resources available at the moment.</p>
        </div>
    {% endif %}
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card shadow">
            <div class="card-header bg-warning text-dark">
                <h5><i class="fas fa-lightbulb me-2"></i>Personalized Suggestions</h5>
            </div>
            <div class="card-body">
                {% if recommendations %}
                <p>Based on your quiz performance and profile, we recommend focusing on:</p>
                <ul>
                    {% for rec in recommendations %}
                    <li>{{ rec }}</li>
                    {% endfor %}
                </ul>
                {% else %}
                <p>Based on your quiz performance and profile, we recommend focusing on:</p>
                <ul>
                    <li>Reviewing privacy settings on your social media accounts</li>
                    <li>Learning about AI ethics and data collection practices</li>
                    <li>Understanding how incognito mode and anonymous data work</li>
                    <li>Practicing good password hygiene and security habits</li>
                </ul>
                {% endif %}
                <a href="{{ url_for('quiz_select') }}" class="btn btn-primary">
                    <i class="fas fa-question-circle me-2"></i>Test Your Knowledge
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function handleResourceClick(event, resourceTitle) {
    // Log the click for analytics (optional)
    console.log('Opening resource:', resourceTitle);
    
    // Validate URL before opening
    const link = event.currentTarget;
    const url = link.href;
    
    // Check if URL is valid
    if (!url || url === '#' || url.includes('example.com')) {
        event.preventDefault();
        alert('This resource URL is not available. Please contact an administrator.');
        return false;
    }
    
    // Show loading state
    const originalHTML = link.innerHTML;
    link.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Opening...';
    link.style.pointerEvents = 'none';
    
    // Reset after a delay (the page should have opened by then)
    setTimeout(() => {
        link.innerHTML = originalHTML;
        link.style.pointerEvents = 'auto';
    }, 2000);
    
    // The link will open normally
    return true;
}

// Add click handlers to all resource links
document.addEventListener('DOMContentLoaded', function() {
    const resourceLinks = document.querySelectorAll('a[target="_blank"]');
    resourceLinks.forEach(function(link) {
        // Add visual feedback
        link.addEventListener('mouseenter', function() {
            this.style.opacity = '0.8';
        });
        link.addEventListener('mouseleave', function() {
            this.style.opacity = '1';
        });
        
        // Check if URL is valid on page load
        if (link.href && (link.href.includes('example.com') || link.href === '#')) {
            link.style.opacity = '0.5';
            link.style.cursor = 'not-allowed';
            link.title = 'This resource URL is not available';
        }
    });
    
    // Add a notice if browser might block popups
    const hasResourceLinks = resourceLinks.length > 0;
    if (hasResourceLinks) {
        console.log('Resource links are ready. If links don\'t open, check your browser\'s popup blocker settings.');
    }
});
</script>
{% endblock %}

